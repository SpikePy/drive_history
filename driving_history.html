<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, user-scalable=no" ZZ/>
    <title>Driving History</title>
    <link rel="icon" type="image/svg+xml" href="images/car.svg">
    <style>
        body {
            text-align:  center;
            font-family: sans-serif;
            font-size:   14pt;
            line-height: 1.3;
            background-color: WhiteSmoke;
        }

        h1 {
            font-size: 3em;
        }

        h2 {
            font-size: 1.75em;
        }

        #interaction-area {
            margin: 2em;
        }

        input {
            text-align: center;
            width: 6em;
            font-size: 1em;
        }

        button {
            margin: 1em auto 1em;
            width: 11em;
            padding: .5em;
            font-size: 1em;
        }

        table {
            margin: .5em auto;
        }
        th {
          padding: 1em 0 0;
        }
        td {
            text-align: left;
            padding: 0 .75em;
        }
        #evaluation tr:last-child td {
            padding-top: 1em;
        }

        .number {
            text-align: right;
        }

        #log > p {
            font-size: 1em;
            padding: 0;
            margin: 0;
            text-decoration: underline .1em;
        }

        .hidden {
            display: none;
        }

        ul {
            margin:  0 0 1em;
            padding: 0;
        }

        li {
            font-size: 1em;
            list-style-type: none;
        }

        .activity_1, .activity_2 {
          color: green;
        }
        .activity_0 {
          display: none;
        }
        .activity_-1, .activity_-2 {
          color: red;
        }
    </style>
    <script src="driving_history_data.js"></script>
    <script>
        function logShow() {
            document.getElementById('button_logShow').classList.add('hidden')
            document.getElementById('evaluation').classList.add('hidden')
            document.getElementById('interaction-area').classList.add('hidden')
            document.getElementById('log').classList.remove('hidden')
        }
        function logHide() {
            document.getElementById('button_logShow').classList.remove('hidden')
            document.getElementById('interaction-area').classList.remove('hidden')
            document.getElementById('evaluation').classList.remove('hidden')
            document.getElementById('log').classList.add('hidden')
        }
        function loaded() {
            today         = new Date()
            year          = today.getYear()+1900
            month         = "" +today.getMonth()+1
            day           = "" +today.getDate()
            date          = `${year}-${month}-${day}`
            td_date.value = date

            ren = []
            Array.from(document.getElementsByClassName('ren')).forEach(el => ren.push(el.value))
            ren.reduce((a,b) => a + b, 0)

            ren_sum = 0; Array.from(document.getElementsByClassName('ren')).forEach(el => ren_sum += el.value)
            mat_sum = 0; Array.from(document.getElementsByClassName('mat')).forEach(el => mat_sum += el.value)
            yve_sum = 0; Array.from(document.getElementsByClassName('yve')).forEach(el => yve_sum += el.value)
            savings = document.getElementsByClassName('activity_-2').length*2 + document.getElementsByClassName('activity_-1').length

            document.getElementById("eval-ren").innerHTML = ren_sum
            document.getElementById("eval-mat").innerHTML = mat_sum
            document.getElementById("eval-yve").innerHTML = yve_sum
            document.getElementById("eval-savings").innerHTML = savings
        }
    </script>
</head>
<body onload="loaded()">
    <h1><src="images/car.svg"> Driving history</h1>


    <div id="interaction-area">
        <h2>Create New Entry</h2>
        <form action="/cgi-bin/drive_entry.cgi" method="post">
            <table>
                <tr>
                    <td>Rene</td>
                    <td><input type='number' name='ren'  value='0' min='-2' max='2'></td>
                </tr>
                <tr>
                    <td>Mattias</td>
                    <td><input type='number' name='mat'  value='0' min='-2' max='2'></td>
                </tr>
                <tr>
                    <td>Yvette</td>
                    <td><input type='number' name='yve'  value='0' min='-2' max='2'></td>
                </tr>
                <tr>
                    <td>Date</td>
                    <td><input type='text'   name='date' value=''  id='td_date' title='YYYY-MM-DD' readonly></td>
                </tr>
            </table>
            <button type='submit'>Submit</button>
        </form>
    </div>

    <div id='evaluation'>
        <h2>Evaluation</h2>
        <table>
            <tr>
                <td>Rene</td>
                <td class='number' class='number'id="eval-ren">-</td>
            </tr>
            <tr>
                <td>Mattdias</td>
                <td class='number' class='number'id="eval-mat">-</td>
            </tr>
            <tr>
                <td>Yvette</td>
                <td class='number' class='number'id="eval-yve">-</td>
            </tr>
            <tr>
                <td>Saved Trips</td>
                <td class='number' id="eval-savings">-</td>
            </tr>
        </table>
    </div>

<!-- CONTENT GENERATED BY CGI-SCRIPT -->
    <button id='button_logShow' onclick='logShow()'>Show Log</button>
    <div class='hidden' id='log'><h2>Log</h2><button id='button_logHide' onclick='logHide()'>Hide Log</button>
<p>2020-01-16 <ul> <li class='ren activity_2' value='2'>Ren√© (2)</li> <li class='mat activity_0' value='0'>Matthias (0)</li> <li class='yve activity_-2' value='-2'>Yvette (-2)</li> </ul> </p>
<p>2020-01-15<ul><li class="ren activity_-2" value="-2">Rene (-2)</li><li class="mat activity_-1" value="-1">Matthias (-1)</li><li class="yve activity_2" value="2">Yvette (2)</li></ul></p>
<p>2020-01-07<ul><li class="mat activity_-2" value="-2">Matthias (-2)</li><li class="ren activity_2" value="2">Rene (2)</li></ul></p>
<p>2020-01-06<ul><li class="ren activity_-2" value="-2">Rene (-2)</li><li class="mat activity_2" value="2">Matthias (2)</li></ul></p>
    </div>
</body>
</html>
